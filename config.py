import os
from dotenv import load_dotenv
from logging_utils import log_and_print

def load_configuration():
    """
    Dynamically load the .env file located in the same directory as the executable.
    """
    import sys

    # Determine the directory of the current executable or script
    if getattr(sys, 'frozen', False):  # Check if running as an executable
        base_dir = os.path.dirname(sys.executable)
    else:  # Running as a Python script
        base_dir = os.path.dirname(os.path.abspath(__file__))

    # Path to the .env file
    env_path = os.path.join(base_dir, '.env')

    # Load the .env file
    if os.path.exists(env_path):
        load_dotenv(env_path, override=True)  # Force override of existing variables
        print(f"✅ Loaded configuration from {env_path}")
    else:
        print(f"❌ Configuration file not found at {env_path}. Please provide a .env file.")
        exit(1)

    required_env_vars = ["BEARER_TOKEN","MONGO_CONNECTION_STRING", "DB_SERVER", "DB_NAME", "DB_USER", "DB_PASS"]

    for var in required_env_vars:
        value = os.getenv(var)
        if not value:
            print(f"❌ Error: Missing required environment variable: {var}")
            exit(1)
        


cases_list = [
    2005164, 2005167, 2005166, 2005014, 2005054, 2004856, 2004883, 2004919, 2004937, 2005070,
    2004888, 2004999, 2004709, 2004761, 2004762, 2004804, 2004805, 2004846, 2004847, 2004851, 
    2004855, 2004880, 2004881, 2004891, 2004892, 2004893, 2004905, 2004909, 2004925, 2004927, 
    2004928, 2004939, 2004952, 2004956, 2004966, 2004969, 2004974, 2004975, 2004989, 2004997, 
    2004998, 2005000, 2005081, 2005083, 2005086, 2005087, 2005089, 2005091, 2005093, 2005094, 
    2005096, 2005097, 2005098, 2005099, 2005100, 2005103, 2005104, 2005106, 2005107, 2005109, 
    2005110, 2005116, 2005117, 2005120, 2005122, 2005124, 2005127, 2005128, 2005129, 2005132, 
    2005133, 2005134, 2005135, 2005138, 2005141, 2005144, 2005146, 2005147, 2005152, 2005154, 
    2005157, 2005158, 2005160, 2005161, 2005162, 2005163, 2004338, 2004339, 2004801, 2004826, 
    2004858, 2004866, 2004869, 2004877, 2004887, 2004894, 2004907, 2004916, 2004917, 2004943, 
    2004944, 2004951, 2004955, 2004964, 2004986, 2005062, 2005148, 2005149, 2005095, 2004693, 
    2004361, 2004807, 2004720, 2004950, 2005168, 2005169, 2005170, 2005019, 2005020, 2005023, 
    2005024, 2005027, 2005028, 2005031, 2005033, 2005034, 2005035, 2005036, 2005037, 2005038, 
    2005041, 2005044, 2005045, 2005046, 2005049, 2005050, 2005052, 2005055, 2005056, 2005057, 
    2005058, 2005059, 2005060, 2005063, 2005065, 2005067, 2005068, 2005069, 2005072, 2005073, 
    2005074, 2005075, 2005076, 2005077, 2005078, 2005080, 2005171, 2005172, 2005102, 2005119, 
    2005142, 2005145, 2005150, 2005151, 2005153, 2005155, 2005159, 2005165, 2004854, 2004982, 
    2005016, 2004782, 2005079, 2005084, 2005085, 2004857, 2004931, 2004995, 2004996, 2005030, 
    2005040, 2005047, 2005048, 2005123, 2005125, 2005137, 2004958, 2004948, 2004949, 2004971, 
    2004978, 2004979, 2004677, 2004890, 2004960, 2004961, 2004970, 2005053, 2005061, 2005004, 
    2005005, 2005006, 2005008, 2005009, 2005012, 2005013, 2005015, 2005017, 2005018, 2004941, 
    2005017, 2004926, 2005002, 2005035, 2005040, 2004875, 2004860, 2004758, 2004759, 2004854, 
    2004885, 2004886, 2004902, 2004903, 2004930, 2004934, 2004962, 2004980, 2005003, 2004874, 
    2005011, 2005025, 2005029, 2005042, 2005055, 2005058, 2005071, 2005088, 2005090, 2004814, 
    2004674, 2004830, 2004943, 2004944, 2004935, 2004793, 2004888, 2004936, 2004984, 2004982, 
    2004982, 2004968
]
