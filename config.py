import os
from dotenv import load_dotenv
from logging_utils import log_and_print

def load_configuration():
    """
    Dynamically load the .env file located in the same directory as the executable.
    """
    import sys

    # Determine the directory of the current executable or script
    if getattr(sys, 'frozen', False):  # Check if running as an executable
        base_dir = os.path.dirname(sys.executable)
    else:  # Running as a Python script
        base_dir = os.path.dirname(os.path.abspath(__file__))

    # Path to the .env file
    env_path = os.path.join(base_dir, '.env')

    # Load the .env file
    if os.path.exists(env_path):
        load_dotenv(env_path, override=True)  # Force override of existing variables
        print(f"✅ Loaded configuration from {env_path}")
    else:
        print(f"❌ Configuration file not found at {env_path}. Please provide a .env file.")
        exit(1)

    required_env_vars = ["BEARER_TOKEN","MONGO_CONNECTION_STRING", "DB_SERVER", "DB_NAME", "DB_USER", "DB_PASS"]

    for var in required_env_vars:
        value = os.getenv(var)
        if not value:
            print(f"❌ Error: Missing required environment variable: {var}")
            exit(1)
        

# """
# cases_list = [
#     2005164, 2005167, 2005166, 2005014, 2005054, 2004856, 2004883, 2004919, 2004937, 2005070,
#     2004888, 2004999, 2004709, 2004761, 2004762, 2004804, 2004805, 2004846, 2004847, 2004851, 
#     2004855, 2004880, 2004881, 2004891, 2004892, 2004893, 2004905, 2004909, 2004925, 2004927, 
#     2004928, 2004939, 2004952, 2004956, 2004966, 2004969, 2004974, 2004975, 2004989, 2004997, 
#     2004998, 2005000, 2005081, 2005083, 2005086, 2005087, 2005089, 2005091, 2005093, 2005094, 
#     2005096, 2005097, 2005098, 2005099, 2005100, 2005103, 2005104, 2005106, 2005107, 2005109, 
#     2005110, 2005116, 2005117, 2005120, 2005122, 2005124, 2005127, 2005128, 2005129, 2005132, 
#     2005133, 2005134, 2005135, 2005138, 2005141, 2005144, 2005146, 2005147, 2005152, 2005154, 
#     2005157, 2005158, 2005160, 2005161, 2005162, 2005163, 2004338, 2004339, 2004801, 2004826, 
#     2004858, 2004866, 2004869, 2004877, 2004887, 2004894, 2004907, 2004916, 2004917, 2004943, 
#     2004944, 2004951, 2004955, 2004964, 2004986, 2005062, 2005148, 2005149, 2005095, 2004693, 
#     2004361, 2004807, 2004720, 2004950, 2005168, 2005169, 2005170, 2005019, 2005020, 2005023, 
#     2005024, 2005027, 2005028, 2005031, 2005033, 2005034, 2005035, 2005036, 2005037, 2005038, 
#     2005041, 2005044, 2005045, 2005046, 2005049, 2005050, 2005052, 2005055, 2005056, 2005057, 
#     2005058, 2005059, 2005060, 2005063, 2005065, 2005067, 2005068, 2005069, 2005072, 2005073, 
#     2005074, 2005075, 2005076, 2005077, 2005078, 2005080, 2005171, 2005172, 2005102, 2005119, 
#     2005142, 2005145, 2005150, 2005151, 2005153, 2005155, 2005159, 2005165, 2004854, 2004982, 
#     2005016, 2004782, 2005079, 2005084, 2005085, 2004857, 2004931, 2004995, 2004996, 2005030, 
#     2005040, 2005047, 2005048, 2005123, 2005125, 2005137, 2004958, 2004948, 2004949, 2004971, 
#     2004978, 2004979, 2004677, 2004890, 2004960, 2004961, 2004970, 2005053, 2005061, 2005004, 
#     2005005, 2005006, 2005008, 2005009, 2005012, 2005013, 2005015, 2005017, 2005018, 2004941, 
#     2005017, 2004926, 2005002, 2005035, 2005040, 2004875, 2004860, 2004758, 2004759, 2004854, 
#     2004885, 2004886, 2004902, 2004903, 2004930, 2004934, 2004962, 2004980, 2005003, 2004874, 
#     2005011, 2005025, 2005029, 2005042, 2005055, 2005058, 2005071, 2005088, 2005090, 2004814, 
#     2004674, 2004830, 2004943, 2004944, 2004935, 2004793, 2004888, 2004936, 2004984, 2004982, 
#     2004982, 2004968
# ]"""
# """
# cases_list = [
#     2005206, 2005285, 2005281, 2005287, 2004338, 2004339, 2001968, 2004759, 2004761, 2004762,
#     2004771, 2004804, 2004805, 2004854, 2004860, 2004891, 2004892, 2004893, 2004905, 2004907,
#     2004916, 2004917, 2004928, 2004951, 2004952, 2004956, 2004964, 2004968, 2004970, 2004971,
#     2004974, 2004984, 2004995, 2004996, 2004999, 2005006, 2005007, 2005011, 2005013, 2005019,
#     2005020, 2005031, 2005036, 2005040, 2005045, 2005048, 2005055, 2004693, 2004930, 2004943,
#     2004944, 2005111, 2005112, 2004361, 2004807, 2004969, 2005288, 2005289, 2005056, 2005058,
#     2005060, 2005061, 2005063, 2005067, 2005068, 2005070, 2005071, 2005074, 2005075, 2005077,
#     2005078, 2005091, 2005094, 2005102, 2005104, 2005106, 2005109, 2005117, 2005119, 2005122,
#     2005125, 2005128, 2005129, 2005130, 2005131, 2005132, 2005134, 2005135, 2005137, 2005145,
#     2005146, 2005147, 2005151, 2005152, 2005154, 2005155, 2005158, 2005159, 2005160, 2005161,
#     2005162, 2005164, 2005263, 2005284, 2005166, 2005167, 2005168, 2005169, 2005170, 2005176,
#     2005177, 2005178, 2005179, 2005183, 2005184, 2005186, 2005187, 2005188, 2005195, 2005196,
#     2005197, 2005198, 2005199, 2005200, 2005202, 2005203, 2005207, 2005208, 2005214, 2005216,
#     2005217, 2005219, 2005220, 2005221, 2005224, 2005226, 2005227, 2005228, 2005229, 2005231,
#     2005232, 2005233, 2005234, 2005235, 2005239, 2005242, 2005244, 2005245, 2004758, 2004975,
#     2004982, 2005025, 2005062, 2005088, 2005090, 2005120, 2005201, 2005262, 2000741, 2004814,
#     2005015, 2005049, 2005052, 2005079, 2005085, 2005087, 2005110, 2005181, 2005182, 2005014,
#     2005053, 2005054, 2005194, 2005222, 2005252, 2004856, 2004887, 2004894, 2004909, 2005059,
#     2005072, 2005073, 2005173, 2005191, 2005218, 2005269, 2004855, 2005127, 2004866, 2004877,
#     2004927, 2004960, 2004961, 2004991, 2004992, 2005089, 2005148, 2005149, 2005163, 2005180,
#     2005241, 2005246, 2005247, 2005248, 2005249, 2005250, 2005251, 2005253, 2005256, 2005257,
#     2005258, 2005259, 2005261, 2005264, 2005268, 2005271, 2005272, 2005273, 2005274, 2005275,
#     2005276, 2005277, 2005278, 2005279, 2005280, 2005282, 2004758, 2004759, 2004854, 2004930,
#     2004980, 2005003, 2005011, 2005025, 2005029, 2005042, 2005055, 2005058, 2005071, 2005088,
#     2005090, 2004674, 2004943, 2004944, 2004982, 2004982, 2005024, 2004826, 2004955, 2004997,
#     2005041, 2004869, 2005069, 2004998, 2004880, 2004881, 2005142, 2004925, 2005057, 2004828,
#     2004827, 2004989, 2004889, 2005081, 2005080
# ]
# """
cases_list = [
    2005393, 2005459, 2005042, 2005055, 2005058, 2005006, 2005078, 2005119, 2005224, 2005050,
    2005036, 2004951, 2004968, 2005203, 2005249, 2005250, 2005259, 2005261, 2005262, 2005217,
    2005183, 2005104, 2005195, 2005109, 2005132, 2005154, 2004880, 2004881, 2005110, 2005049,
    2001968, 2004907, 2005073, 2005072, 2005170, 2005200, 2000741, 2005114, 2005113, 2005234,
    2005199, 2004928, 2005177, 2005015, 2005061, 2004893, 2004956, 2005013, 2004814, 2005309,
    2005311, 2005313, 2005389, 2005385, 2005309, 2005062, 2005071, 2005088, 2005090, 2005102,
    2005208, 2005214, 2004433, 2004964, 2005060, 2005020, 2005019, 2005131, 2005130, 2005239,
    2005187, 2004889, 2004905, 2005091, 2005290, 2004693, 2005048, 2005054, 2005009, 2004858,
    2004877, 2005089, 2005166, 2005287, 2005288, 2005289, 2005295, 2005296, 2005299, 2005304,
    2005305, 2005307, 2005308, 2005312, 2005314, 2005315, 2005317, 2005319, 2005320, 2005323,
    2005324, 2005326, 2005328, 2005331, 2005334, 2005335, 2005336, 2005338, 2005339, 2005340,
    2005342, 2005343, 2005344, 2005346, 2005347, 2005348, 2005351, 2005352, 2005354, 2005356,
    2005357, 2005358, 2005360, 2005282, 2005361, 2005363, 2005365, 2005366, 2005367, 2005368,
    2005369, 2005370, 2005371, 2005373, 2005378, 2005382, 2005386, 2005388, 2005390, 2005391,
    2005392, 2005394, 2005396, 2005397, 2005399, 2005401, 2005402, 2005403, 2005404, 2005405,
    2005407, 2005408, 2005409, 2005410, 2005411, 2005412, 2005415, 2005417, 2005418, 2005421,
    2005422, 2005424, 2005425, 2005427, 2005428, 2005429, 2005430, 2005431, 2005434, 2005436,
    2005437, 2005438, 2005439, 2005440, 2005442, 2005447, 2005448, 2005451, 2005456, 2005457,
    2005460, 2005461, 2005462, 2005463, 2005464, 2005465, 2005466, 2005467, 2005469, 2005470,
    2005473, 2005474, 2005475, 2005476, 2005477, 2004894, 2004960, 2004961, 2005007, 2005074,
    2005075, 2005113, 2005114, 2005122, 2005125, 2005128, 2005129, 2005137, 2005148, 2005149,
    2005155, 2005158, 2005163, 2005165, 2005191, 2005196, 2005199, 2005200, 2005203, 2005218,
    2005220, 2005225, 2005228, 2005229, 2005230, 2005235, 2005241, 2005242, 2005244, 2005245,
    2005251, 2005253, 2005257, 2005258, 2005264, 2005269, 2005270, 2005272, 2005277, 2005226,
    2005249, 2005250, 2005279, 2005332, 2005372, 2005400, 2005443, 2004974, 2005015, 2005219,
    2005291, 2005294, 2005329, 2005330, 2005355, 2005170, 2005179, 2005234, 2005284, 2005376,
    2005377, 2005455, 2005458, 2005151, 2005398, 2005453, 2004991, 2004992, 2005060, 2005157,
    2005306, 2005395, 2005145, 2005073, 2005072, 2005069, 2005061, 2005161, 2005160, 2005159,
    2005085, 2005079, 2004762, 2001968, 2004339, 2004338, 2005217, 2005216, 2005198, 2005197,
    2005188, 2005014, 2004975, 2005078, 2005259, 2005261, 2005262, 2005478, 2005479, 2005471,
    2005472
]


caseid_table = caseid_table = [
                    2005282, 2005361, 2005363, 2005365, 2005366, 2005367, 2005368, 2005369, 2005370, 2005371,
                    2005373, 2005378, 2005382, 2005386, 2005388, 2005390, 2005391, 2005392, 2005394, 2005396,
                    2005397, 2005399, 2005401, 2005402, 2005403, 2005404, 2005405, 2005407, 2005408, 2005409,
                    2005410, 2005411, 2005412, 2005415, 2005417, 2005418, 2005421, 2005422, 2005424, 2005425,
                    2005427, 2005428, 2005429, 2005430, 2005431, 2005434, 2005436, 2005437, 2005438, 2005439,
                    2005440, 2005442, 2005447, 2005448, 2005451, 2005456, 2005457, 2005460, 2005461, 2005462,
                    2005463, 2005464, 2005465, 2005466, 2005467, 2005469, 2005470, 2005473, 2005474, 2005475,
                    2005476, 2005477, 2005078, 2005259, 2005261, 2005262, 2004693, 2005048, 2005054, 2005009,
                    2004858, 2004877, 2005089, 2005166, 2004894, 2004960, 2004961, 2005007, 2005074, 2005075,
                    2005113, 2005114, 2005122, 2005125, 2005128, 2005129, 2005137, 2005148, 2005149, 2005155,
                    2005158, 2005163, 2005165, 2005191, 2005196, 2005199, 2005200, 2005203, 2005218, 2005220,
                    2005225, 2005228, 2005229, 2005230, 2005235, 2005241, 2005242, 2005244, 2005245, 2005251,
                    2005253, 2005257, 2005258, 2005264, 2005269, 2005270, 2005272, 2005277, 2005226, 2005249,
                    2005250, 2005279, 2005332, 2005372, 2005400, 2005443, 2004974, 2005015, 2005219, 2005291,
                    2005294, 2005329, 2005330, 2005355, 2005170, 2005179, 2005234, 2005284, 2005376, 2005377,
                    2005455, 2005458, 2005151, 2005398, 2005453, 2004991, 2004992, 2005060, 2005157, 2005306,
                    2005395, 2005145, 2005073, 2005072, 2005069, 2005061, 2005161, 2005160, 2005159, 2005085,
                    2005079, 2004762, 2001968, 2004339, 2004338, 2005217, 2005216, 2005198, 2005197, 2005188,
                    2005014, 2004975, 2005287, 2005288, 2005289, 2005295, 2005296, 2005299, 2005304, 2005305,
                    2005307, 2005308, 2005312, 2005314, 2005315, 2005317, 2005319, 2005320, 2005323, 2005324,
                    2005326, 2005328, 2005331, 2005334, 2005335, 2005336, 2005338, 2005339, 2005340, 2005342,
                    2005343, 2005344, 2005346, 2005347, 2005348, 2005351, 2005352, 2005354, 2005356, 2005357,
                    2005358, 2005360
                    ]
decisionid_table = [
                    36776, 29291, 29307, 29377, 29313, 29341, 29334, 29336, 29335, 29411,
                    29412, 29349, 29381, 29370, 29444, 29401, 29397, 29400, 29383, 29409,
                    29415, 29402, 29416, 29393, 29394, 29507, 29457, 29504, 29434, 29440,
                    29488, 29490, 29491, 29458, 29492, 29503, 29518, 29519, 29580, 29536,
                    29537, 29532, 29558, 29654, 29612, 29567, 29554, 29586, 29557, 29583,
                    29597, 29587, 29613, 29611, 29651, 29709, 29710, 29770, 29657, 29670,
                    29784, 29724, 29752, 29792, 29753, 29801, 29820, 29808, 29809, 29813,
                    29823, 29824, 29467, 29624, 29625, 29626, 34537, 36655, 36218, 36341,
                    35597, 36046, 36645, 35739, 29762, 29113, 29114, 36706, 29635, 29636,
                    28978, 28979, 29470, 36485, 29367, 29368, 36710, 29183, 29184, 36235,
                    29721, 29080, 29540, 29826, 36184, 36181, 29619, 29688, 29103, 29698,
                    28960, 36757, 36739, 29652, 29319, 29068, 36696, 29737, 29738, 36976,
                    36879, 29329, 29330, 29680, 36949, 36944, 36975, 29618, 29782, 29754,
                    29755, 29588, 29692, 29767, 29661, 29593, 29739, 29718, 29822, 29811,
                    29812, 29453, 29454, 29714, 29827, 29679, 29638, 29566, 29687, 29594,
                    29641, 29825, 29705, 29725, 29694, 29282, 29283, 29766, 29743, 29084,
                    29396, 29778, 36886, 36885, 29582, 29726, 29685, 29684, 29715, 29720,
                    29719, 29672, 29763, 29735, 29734, 29787, 29691, 29549, 29548, 29779,
                    29500, 29591, 28996, 28974, 28975, 29278, 29033, 29340, 29690, 29073,
                    29085, 29139, 29128, 29501, 29544, 29433, 29155, 29156, 29627, 29628,
                    29168, 29600, 29768, 29223, 29207, 29276, 29369, 29219, 29224, 29226,
                    29239, 29229, 29266, 29325, 29326, 29310, 29376, 29275, 29783, 29828,
                    29829, 29315
                ]

subdecision_table = [
                    36776, 29291, 29307, 29377, 29313, 29341, 29334, 29336, 29335, 29411,
                    29412, 29349, 29381, 29370, 29444, 29401, 29397, 29400, 29383, 29409,
                    29415, 29402, 29416, 29393, 29394, 29507, 29457, 29504, 29434, 29440,
                    29488, 29490, 29491, 29458, 29492, 29503, 29518, 29519, 29580, 29536,
                    29537, 29532, 29558, 29654, 29612, 29567, 29554, 29586, 29557, 29583,
                    29597, 29587, 29613, 29611, 29651, 29709, 29710, 29770, 29657, 29670,
                    29784, 29724, 29752, 29792, 29753, 29801, 29820, 29808, 29809, 29813,
                    29823, 29824, 29467, 29624, 29625, 29626, 34537, 36655, 36218, 36341,
                    35597, 36046, 36645, 35739, 29762, 29113, 29114, 36706, 29635, 29636,
                    28978, 28979, 29470, 36485, 29367, 29368, 36710, 29183, 29184, 36235,
                    29721, 29080, 29540, 29826, 36184, 36181, 29619, 29688, 29103, 29698,
                    28960, 36757, 36739, 29652, 29319, 29068, 36696, 29737, 29738, 36976,
                    36879, 29329, 29330, 29680, 36949, 36944, 36975, 29618, 29782, 29754,
                    29755, 29588, 29692, 29767, 29661, 29593, 29739, 29718, 29822, 29811,
                    29812, 29453, 29454, 29714, 29827, 29679, 29638, 29566, 29687, 29594,
                    29641, 29825, 29705, 29725, 29694, 29282, 29283, 29766, 29743, 29084,
                    29396, 29778, 36886, 36885, 29582, 29726, 29685, 29684, 29715, 29720,
                    29719, 29672, 29763, 29735, 29734, 29787, 29691, 29549, 29548, 29779,
                    29500, 29591, 28996, 28974, 28975, 29278, 29033, 29340, 29690, 29073,
                    29085, 29139, 29128, 29501, 29544, 29433, 29155, 29156, 29627, 29628,
                    29168, 29600, 29768, 29223, 29207, 29276, 29369, 29219, 29224, 29226,
                    29239, 29229, 29266, 29325, 29326, 29310, 29376, 29275, 29783, 29828,
                    29829, 29315
                ]
